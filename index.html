<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ© ì¸ìŠ¤íƒ€ ìŠ¤í† ë¦¬ ìë™ ìƒì„±ê¸°</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-6">
  <div class="w-full max-w-2xl bg-white p-6 rounded-lg shadow-xl">
    <h1 class="text-2xl font-bold text-blue-700 mb-4">ğŸ© ì¸ìŠ¤íƒ€ ìŠ¤í† ë¦¬ ìë™ ìƒì„±ê¸°</h1>

    <label class="block mb-2 font-semibold">ğŸ“¦ ìƒí’ˆëª…</label>
    <input type="text" id="productName" class="w-full border rounded px-3 py-2 mb-4" placeholder="ì˜ˆ: íŒŒë¦¬ì§€ì–‘ ì„¼ì„œíœ´ì§€í†µ" />

    <label class="block mb-2 font-semibold">ğŸ”— ì¿ íŒ¡ ë§í¬</label>
    <input type="text" id="productLink" class="w-full border rounded px-3 py-2 mb-4" placeholder="https://link.coupang.com/a/xxxxx" />

    <label class="block mb-2 font-semibold">âœ¨ ìƒí’ˆ ì¥ì  (3ê°€ì§€, ì¤„ë°”ê¿ˆìœ¼ë¡œ ì…ë ¥)</label>
    <textarea id="advantages" class="w-full border rounded px-3 py-2 mb-4" rows="3" placeholder="- ì‚¬ìš© í¸í•˜ê³  ìœ„ìƒì ì´ì–´ìš”&#10;- ì„¼ì„œ ë°˜ì‘ì´ ë¹ ë¥¸ íœ´ì§€í†µ&#10;- ì–´ëŠ ê³³ì—ë‚˜ ì–´ìš¸ë¦¬ëŠ” ë””ìì¸"></textarea>

    <label class="block mb-2 font-semibold">ğŸ–¼ï¸ ìŠ¤í† ë¦¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
    <input type="file" id="imageInput" class="mb-4" multiple accept="image/*" />

    <label class="block mb-2 font-semibold">ğŸ“ í•´ì‹œíƒœê·¸</label>
    <input type="text" id="hashtags" class="w-full border rounded px-3 py-2 mb-4" placeholder="#ì„¼ì„œíœ´ì§€í†µ #ì£¼ë°©í…œ #ìƒí™œê¿€íŒ" />

    <button onclick="generateZIP()" class="w-full bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700">âœ… ìŠ¤í† ë¦¬ ì»¨í…ì¸  ìƒì„±</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script>
    function generateZIP() {
      const productName = document.getElementById("productName").value.trim();
      const productLink = document.getElementById("productLink").value.trim();
      const advantages = document.getElementById("advantages").value.split('\n').filter(adv => adv.trim() !== '');
      const hashtags = document.getElementById("hashtags").value.trim();
      const imageFiles = document.getElementById("imageInput").files;

      // ìœ íš¨ì„± ê²€ì‚¬
      if (!productName || !productLink || advantages.length === 0) {
        alert('ìƒí’ˆëª…, ì¿ íŒ¡ ë§í¬, ìƒí’ˆ ì¥ì ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      if (!productLink.startsWith('https://link.coupang.com')) {
        alert('âš ï¸ ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ ë§í¬ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      let textContent = `ğŸ™Œ ${productName}\n`;
      advantages.forEach((adv, idx) => {
        textContent += `${idx + 1}. ${adv.trim()}\n`;
      });
      textContent += `\nğŸ‘‡ ì œí’ˆ ë³´ëŸ¬ê°€ê¸°\n${productLink}\n\n${hashtags || '#ì„¼ì„œíœ´ì§€í†µ #ì£¼ë°©í…œ #ìƒí™œê¿€íŒ'}`;

      const zip = new JSZip();
      zip.file("story.txt", textContent);
      zip.file("hashtags.txt", hashtags || '#ì„¼ì„œíœ´ì§€í†µ #ì£¼ë°©í…œ #ìƒí™œê¿€íŒ');

      // ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš° í…ìŠ¤íŠ¸ë§Œ ë‹¤ìš´ë¡œë“œ
      if (imageFiles.length === 0) {
        zip.generateAsync({ type: "blob" }).then(function (blob) {
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "insta_story_package.zip";
          a.click();
        });
        return;
      }

      let loaded = 0;
      for (let i = 0; i < imageFiles.length; i++) {
        const reader = new FileReader();
        reader.onload = (function(index, file) {
          return function(e) {
            const base64 = e.target.result.split(",")[1];
            const ext = file.name.split('.').pop().toLowerCase();
            zip.file(`image_${index + 1}.${ext}`, base64, { base64: true });
            loaded++;
            if (loaded === imageFiles.length) {
              zip.generateAsync({ type: "blob" }).then(function (blob) {
                const a = document.createElement("a");
                a.href = URL.createObjectURL(blob);
                a.download = "insta_story_package.zip";
                a.click();
              });
            }
          }
        })(i, imageFiles[i]);
        reader.readAsDataURL(imageFiles[i]);
      }
    }
  </script>
</body>
</html>